<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Mizuhiro Suzuki" />


<title>Replication of Thomas &amp; Worrall (1988), Figure 1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Risk Sharing</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="RiskSharingLit.html">Literature</a>
</li>
<li>
  <a href="CR93_code.html">Coate and Ravallion (1993)</a>
</li>
<li>
  <a href="LTW_code.html">Ligon et al. (2002)</a>
</li>
<li>
  <a href="Laczo2015_code.html">Laczó (2015)</a>
</li>
<li>
  <a href="TW88_code.html">Thomas and Worrall (1988)</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Replication of Thomas &amp; Worrall (1988), Figure 1</h1>
<h4 class="author">Mizuhiro Suzuki</h4>
<h4 class="date">5/10/2018</h4>

</div>


<div id="replication-of-figure-1" class="section level2">
<h2>Replication of Figure 1</h2>
<p>In this document I replicate Figure 1 of Thomas &amp; Worrall (1988). For this, I need to derive 4 end-points of wage intervals: <span class="math inline">\(\omega_{1, lower}, \omega_{1, upper}, \omega_{2, lower}, \omega_{2, upper}\)</span>. However, note that <span class="math inline">\(\omega_{1, lower} = w(1)\)</span> and <span class="math inline">\(\omega_{2, upper} = w(2)\)</span> by Proposition 3. Therefore, below I show how to derive the other two end-points and replicate the figure.</p>
<div id="case-1-no-overlap" class="section level3">
<h3>Case 1: No overlap</h3>
<p>First, I consider the case where there is no overlap (<span class="math inline">\(\omega_{1, upper} &lt; \omega_{2, lower}\)</span>). To calculate the end-points of the intervals, evaluate profits at the top of the state 1 interval (where the discounted utility is 0) and utility at the bottom of the state 2 intervals (where the discounted profit is 0). Note that once these end-points are realized, in the next period the contract pays wages <span class="math inline">\(\omega_{1, upper}\)</span> and <span class="math inline">\(\omega_{2, lower}\)</span> with probabilities <span class="math inline">\(p(1)\)</span> and <span class="math inline">\(p(2)\)</span>, respectively, and this pattern continues forever. (In some sense this is a steady ``state’’ where contract payments bounce around between <span class="math inline">\(\omega_{1, upper}\)</span> and <span class="math inline">\(\omega_{2, lower}\)</span>, but not otehr payments.) The conditions are</p>
<p><span class="math inline">\(\begin{aligned} &amp;\quad w(1) - \omega_{1,upper} + \frac{\alpha}{1 - \alpha} (p(1) (w(1) - \omega_{1, upper}) + p(2) (w(2) - \omega_{2, lower})) &amp;= 0 \\ &amp;\Leftrightarrow (1 - \alpha) (w(1) - \omega_{1,upper}) + \alpha ((1 - p(2)) (w(1) - \omega_{1, upper}) + p(2) (w(2) - \omega_{2, lower})) &amp;= 0 \\ &amp;\Leftrightarrow (1 - \alpha p(2)) (w(1) - \omega_{1,upper}) - \alpha p(2) (\omega_{2, lower} - w(2))) &amp;= 0 \\ \end{aligned}\)</span></p>
<p>and</p>
<p><span class="math inline">\(\begin{aligned} &amp;\quad u(\omega_{2,lower}) - u(w(2)) + \frac{\alpha}{1 - \alpha} (p(1) (u(\omega_{1, upper}) - u(w(1))) + p(2) (u(\omega_{2, lower}) - u(w(2)))) &amp;= 0 \\ &amp;\Leftrightarrow (1 - \alpha) (u(\omega_{2,lower}) - u(w(2))) + \alpha (p(1) (u(\omega_{1, upper}) - u(w(1))) + (1 - p(1)) (u(\omega_{2, lower}) - u(w(2)))) &amp;= 0 \\ &amp;\Leftrightarrow \alpha p(1) (u(\omega_{1, upper}) - u(w(1))) - (1 - \alpha p(1)) (u(w(2)) - u(\omega_{2, lower})) &amp;= 0 \end{aligned}\)</span></p>
<p>Below, I define a function to solve this system of equations:</p>
<pre class="r"><code># Define utility function
u &lt;- function(x){
  object &lt;- sqrt(x)
  return(object)
}</code></pre>
<pre class="r"><code># Set the parameter values
w_1 &lt;- 1
w_2 &lt;- 4
p_1 &lt;- 1 / 2
p_2 &lt;- 1 / 2</code></pre>
<pre class="r"><code># For the case where there is no overlap, solve \omega_{2, lower} and \omega_{1, upper}

no_overlap &lt;- function(x, alpha, w_1, w_2, p_1, p_2){
  y &lt;- numeric(2)
  y[1] &lt;- (1 - alpha * p_2)  * (w_1 - x[1]) - alpha * p_2 * (x[2] - w_2)
  y[2] &lt;- alpha * p_1 * (u(x[1]) - u(w_1)) - (1 - alpha * p_1) * (u(w_2) - u(x[2]))
  return(y)
}</code></pre>
<p>Given the function to solve <span class="math inline">\(\omega_{2, lower}\)</span> and <span class="math inline">\(\omega_{1, upper}\)</span>, I obtain the value of <span class="math inline">\(\alpha_*\)</span>, the cutoff of no-overlap and spot-market-like situations. Also, I calculate the value of <span class="math inline">\(\alpha^*\)</span>, the cutoff of no-overlap and overlapping situations.</p>
<pre class="r"><code>alpha_vals &lt;- seq(0.50, 0.999, by = 0.0001)
omega_1_upper_vals_no_overlap &lt;- numeric(length(alpha_vals))
omega_2_lower_vals_no_overlap &lt;- numeric(length(alpha_vals))
same_as_spot &lt;- numeric(length(alpha_vals))
x_start &lt;- c((1 + 4) / 2, (1 + 4) / 2)
for (alpha in 1:length(alpha_vals)){
  no_overlap_solutions &lt;- nleqslv(x_start, 
                                  no_overlap, 
                                  alpha = alpha_vals[alpha], 
                                  w_1 = w_1,
                                  w_2 = w_2,
                                  p_1 = p_1,
                                  p_2 = p_2)$x
  omega_1_upper_vals_no_overlap[alpha] &lt;- no_overlap_solutions[1]
  omega_2_lower_vals_no_overlap[alpha] &lt;- no_overlap_solutions[2]
  same_as_spot[alpha] &lt;- is.logical(all.equal(no_overlap_solutions[1], w_1, tolerance = 1e-3))
}

alpha_lower_star &lt;- alpha_vals[max(which(same_as_spot == 1))]
alpha_upper_star &lt;- alpha_vals[min(which(omega_1_upper_vals_no_overlap 
                                         &gt;= omega_2_lower_vals_no_overlap))]</code></pre>
<p>It turned out that <span class="math inline">\(\alpha_*\)</span> is 0.8285, and <span class="math inline">\(\alpha^*\)</span> is 0.9173.</p>
</div>
<div id="case-2-overlapping" class="section level3">
<h3>Case 2: Overlapping</h3>
<p>Next, I consider the case where there are overlaps. In the same way as above, to calculate the end-points of the intervals, evaluate profits at the top of the state 1 interval (where the discounted utility is 0) and utility at the bottom of the state 2 intervals (where the discounted profit is 0): Note that once these end-points are realized, the future contract payments are unchanged no matter which state realizes (see Proposition 2). The conditions are</p>
<p><span class="math inline">\(\begin{aligned} &amp;\quad w(1) - \omega_{1,upper} + \frac{\alpha}{1 - \alpha} (p(1) (w(1) - \omega_{1, upper}) + p(2) (w(2) - \omega_{1, upper})) &amp;= 0 \\ &amp;\Leftrightarrow (1 - \alpha) (w(1) - \omega_{1,upper}) + \alpha ((1 - p(2)) (w(1) - \omega_{1, upper}) + p(2) (w(2) - \omega_{1, upper})) &amp;= 0 \\ &amp;\Leftrightarrow \omega_{1,upper} - (1 - \alpha p(2)) w(1) - \alpha p(2) w(2) &amp;= 0 \\ \end{aligned}\)</span></p>
<p>and</p>
<p><span class="math inline">\(\begin{aligned} &amp;\quad u(\omega_{2,lower}) - u(w(2)) + \frac{\alpha}{1 - \alpha} (p(1) (u(\omega_{2, lower}) - u(w(1))) + p(2) (u(\omega_{2, lower}) - u(w(2)))) &amp;= 0 \\ &amp;\Leftrightarrow (1 - \alpha) (u(\omega_{2,lower}) - u(w(2))) + \alpha (p(1) (u(\omega_{2, lower}) - u(w(2))) + (1 - p(1)) (u(\omega_{2, lower}) - u(w(2)))) &amp;= 0 \\ &amp;\Leftrightarrow u(\omega_{2, lower}) - \alpha p(1) u(w(1)) - (1 - \alpha p(1)) u(w(2)) &amp;= 0 \end{aligned}\)</span></p>
<p>Below I define the function to solve this system of equations:</p>
<pre class="r"><code># For the case where there are overlaps, solve \omega_{2, lower} and \omega_{1, upper}

overlap &lt;- function(x, alpha, w_1, w_2, p_1, p_2){
  y &lt;- numeric(2)
  y[1] &lt;- x[1] - (1 - alpha * p_2) * w_1 - alpha * p_2 * w_2
  y[2] &lt;- u(x[2]) - alpha * p_1 * u(w_1) - (1 - alpha * p_1) * u(w_2)
  return(y)
}</code></pre>
<p>and the end-points at each <span class="math inline">\(\alpha\)</span> are calculated as follows:</p>
<pre class="r"><code>alpha_vals &lt;- seq(0.50, 0.999, by = 0.0001)
omega_1_upper_vals_overlap &lt;- numeric(length(alpha_vals))
omega_2_lower_vals_overlap &lt;- numeric(length(alpha_vals))
x_start &lt;- c((1 + 4) / 2, (1 + 4) / 2)
for (alpha in 1:length(alpha_vals)){
  overlap_solutions &lt;- nleqslv(x_start, 
                                  overlap, 
                                  alpha = alpha_vals[alpha], 
                                  w_1 = w_1,
                                  w_2 = w_2,
                                  p_1 = p_1,
                                  p_2 = p_2)$x
  omega_1_upper_vals_overlap[alpha] &lt;- overlap_solutions[1]
  omega_2_lower_vals_overlap[alpha] &lt;- overlap_solutions[2]
}</code></pre>
</div>
<div id="replicate-the-figure" class="section level3">
<h3>Replicate the figure</h3>
<p>With the information at hand, I replicate Figure 1 in the original paper:</p>
<pre class="r"><code>alpha_vals &lt;- seq(0.50, 0.999, by = 0.0001)

omega_1_upper_vals &lt;- numeric(length(alpha_vals))
omega_2_lower_vals &lt;- numeric(length(alpha_vals))
x_start &lt;- c((1 + 4) / 2, (1 + 4) / 2)
for (alpha in 1:length(alpha_vals)){
  # The payments are the same as the spot market wages
  if (alpha_vals[alpha] &lt;= alpha_lower_star){
    omega_1_upper_vals[alpha] &lt;- w_1
    omega_2_lower_vals[alpha] &lt;- w_2
  } else if (alpha_vals[alpha] &gt; alpha_lower_star &amp; alpha_vals[alpha] &lt;= alpha_upper_star){
    omega_1_upper_vals[alpha] &lt;- omega_1_upper_vals_no_overlap[alpha]
    omega_2_lower_vals[alpha] &lt;- omega_2_lower_vals_no_overlap[alpha]
  } else {
    omega_1_upper_vals[alpha] &lt;- omega_1_upper_vals_overlap[alpha]
    omega_2_lower_vals[alpha] &lt;- omega_2_lower_vals_overlap[alpha]
  }
}

omega_1_lower_vals &lt;- rep(w_1, length(alpha_vals))
omega_2_upper_vals &lt;- rep(w_2, length(alpha_vals))

ggplot() +
  geom_line(aes(alpha_vals, omega_1_upper_vals, color=&quot;a&quot;)) + 
  geom_line(aes(alpha_vals, omega_2_upper_vals, color=&quot;b&quot;)) + 
  geom_line(aes(alpha_vals, omega_1_lower_vals, color=&quot;c&quot;)) + 
  geom_line(aes(alpha_vals, omega_2_lower_vals, color=&quot;d&quot;)) +
  coord_cartesian(xlim = c(alpha_lower_star-0.1, 1.0)) +
  geom_ribbon(aes(x = alpha_vals, ymin = omega_1_lower_vals, ymax = omega_1_upper_vals), 
              fill = &quot;orange&quot;, alpha = 0.2) + 
  geom_ribbon(aes(x = alpha_vals, ymin = omega_2_lower_vals, ymax = omega_2_upper_vals), 
              fill = &quot;green&quot;, alpha = 0.2) +
  scale_color_manual(name = &quot;End-points&quot;, values = c(&quot;blue&quot;, &quot;purple&quot;, &quot;brown&quot;, &quot;red&quot;), 
                     labels = c(&quot;omega_1_upper&quot;, &quot;omega_2_upper&quot;, &quot;omega_1_lower&quot;, &quot;omega_2_lower&quot;)) +
  xlab(&quot;Discount factor&quot;) +
  ylab(&quot;Wages&quot;)</code></pre>
<p><img src="TW88_code_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>I could replicate the figure! Yay!!</p>
</div>
</div>
<div id="fun-exercise-how-wages-change-over-time-in-response-to-spot-market-wage-shocks" class="section level2">
<h2>Fun Exercise: How wages change over time in response to spot market wage shocks</h2>
<p>Now that we could replicate the figure in the original paper, I will next see how contract wages actually change in response to spot market wage shocks. This is the function to create the figure:</p>
<pre class="r"><code>wage_change_plot &lt;- function(w_init, alpha, n, high_wage_dummy){
  # Sequence of spot market wages
  spot_wage &lt;- high_wage_dummy * w_2 + (1 - high_wage_dummy) * w_1
  
  # Given the initial wage, derive the sequence of wages
  
  if (alpha &lt;= alpha_lower_star){
    omega_1_upper &lt;- w_1
    omega_2_lower &lt;- w_2
  } else if (alpha &gt; alpha_lower_star &amp; alpha &lt;= alpha_upper_star){
    no_overlap_solutions &lt;- nleqslv(x_start, 
                                    no_overlap, 
                                    alpha = alpha, 
                                    w_1 = w_1,
                                    w_2 = w_2,
                                    p_1 = p_1,
                                    p_2 = p_2)$x
    omega_1_upper &lt;- no_overlap_solutions[1]
    omega_2_lower &lt;- no_overlap_solutions[2]
  } else {
    overlap_solutions &lt;- nleqslv(x_start, 
                                    overlap, 
                                    alpha = alpha, 
                                    w_1 = w_1,
                                    w_2 = w_2,
                                    p_1 = p_1,
                                    p_2 = p_2)$x
    omega_1_upper &lt;- overlap_solutions[1]
    omega_2_lower &lt;- overlap_solutions[2]
  }
  
  omega &lt;- w_init
  omega_seq &lt;- numeric(n)
  update_seq &lt;- rep(&quot;&quot;, n)
  if (alpha &lt; alpha_lower_star){
    omega_seq &lt;- spot_wage
    update_seq &lt;- rep(&quot;Co-move with Spot Market Wage&quot;, n)
  } else if (alpha &gt;= alpha_lower_star &amp; alpha &lt; alpha_upper_star){
    for (i in 1:n){
      if (omega &gt;= omega_2_lower){
        omega_seq[i] &lt;- omega * high_wage_dummy[i] + omega_1_upper * (1 - high_wage_dummy[i])
        omega &lt;- omega_seq[i]
        if (high_wage_dummy[i] == 1){
          update_seq[i] &lt;- &quot;Wage Unchanged&quot;
        } else {
          update_seq[i] &lt;- &quot;Wage Updated to omega_1_upper&quot;
        }
      } else if (omega &lt; omega_2_lower &amp; omega &gt; omega_1_upper){
        omega_seq[i] &lt;- omega_2_lower * high_wage_dummy[i] + omega_1_upper * (1 - high_wage_dummy[i])
        omega &lt;- omega_seq[i]
        if (high_wage_dummy[i] == 1){
          update_seq[i] &lt;- &quot;Wage Updated to omega_2_lower&quot;
        } else {
          update_seq[i] &lt;- &quot;Wage Updated to omega_1_upper&quot;
        }
      } else {
        omega_seq[i] &lt;- omega_2_lower * high_wage_dummy[i] + omega * (1 - high_wage_dummy[i])
        omega &lt;- omega_seq[i]
        if (high_wage_dummy[i] == 1){
          update_seq[i] &lt;- &quot;Wage Updated to omega_2_lower&quot;
        } else {
          update_seq[i] &lt;- &quot;Wage Unchanged&quot;
        }
      }
    }
  } else {
    for (i in 1:n){
      if (omega &lt;= omega_2_lower){
        omega_seq[i] &lt;- omega_2_lower * high_wage_dummy[i] + omega * (1 - high_wage_dummy[i])
        omega &lt;- omega_seq[i]
        if (high_wage_dummy[i] == 1){
          update_seq[i] &lt;- &quot;Wage Unchanged&quot;
        } else {
          update_seq[i] &lt;- &quot;Wage Updated to omega_1_upper&quot;
        }
      } else if (omega &gt; omega_2_lower &amp; omega &lt; omega_1_upper){
        omega_seq[i] &lt;- omega
        omega &lt;- omega_seq[i]
        if (high_wage_dummy[i] == 1){
          update_seq[i] &lt;- &quot;Wage Updated to omega_2_lower&quot;
        } else {
          update_seq[i] &lt;- &quot;Wage Updated to omega_1_upper&quot;
        }
      } else {
        omega_seq[i] &lt;- omega * high_wage_dummy[i] + omega_1_upper * (1 - high_wage_dummy[i])
        omega &lt;- omega_seq[i]
        if (high_wage_dummy[i] == 1){
          update_seq[i] &lt;- &quot;Wage Updated to omega_2_lower&quot;
        } else {
          update_seq[i] &lt;- &quot;Wage Unchanged&quot;
        }
      }
    }

  }
  
  plot_test &lt;- ggplot() +
                geom_line(aes(alpha_vals, omega_1_upper_vals, color=&quot;a&quot;)) + 
                geom_line(aes(alpha_vals, omega_2_upper_vals, color=&quot;b&quot;)) + 
                geom_line(aes(alpha_vals, omega_1_lower_vals, color=&quot;c&quot;)) + 
                geom_line(aes(alpha_vals, omega_2_lower_vals, color=&quot;d&quot;)) +
                coord_cartesian(xlim = c(alpha_lower_star-0.1, 1.0)) +
                geom_ribbon(aes(x = alpha_vals, ymin = omega_1_lower_vals, 
                                ymax = omega_1_upper_vals), fill = &quot;orange&quot;, alpha = 0.2) + 
                geom_ribbon(aes(x = alpha_vals, ymin = omega_2_lower_vals, 
                                ymax = omega_2_upper_vals), fill = &quot;green&quot;, alpha = 0.2) +
                geom_vline(xintercept = alpha, color = &quot;black&quot;, size = 0.8, alpha = 0.6) +
                scale_color_manual(name = &quot;End-points&quot;, values = c(&quot;blue&quot;, &quot;purple&quot;, &quot;brown&quot;, &quot;red&quot;), 
                                   labels = c(&quot;omega_1_upper&quot;, &quot;omega_2_upper&quot;, &quot;omega_1_lower&quot;, &quot;omega_2_lower&quot;)) +
                xlab(&quot;Discount factor&quot;) +
                ylab(&quot;Wages&quot;) +
                geom_point(aes(rep(alpha, (n + 1)), c(w_init, omega_seq))) +
                geom_label_repel(
                  aes(rep(alpha, (n + 1)), c(w_init, omega_seq), label = seq(0,n)),
                  box.padding = 0.35, point.padding = 0.5)
  
  omega_table &lt;- data.frame(cbind(seq(0,n), round(c(w_init, omega_seq), 3), 
                                  c(NaN, spot_wage), c(&quot;&quot;, update_seq)))
  colnames(omega_table) &lt;- c(&quot;Period&quot;, &quot;Contract Payments&quot;, &quot;Spot Market Wage&quot;, &quot;Wage Update&quot;)
  return(list(plot_test, omega_table))
}</code></pre>
<p>Given this function, I create several graphs how contract wages change.</p>
<div id="case-1-no-overlap-1" class="section level3">
<h3>Case 1: No overlap</h3>
<p>First, I consider the case where initial wage is high.</p>
<pre class="r"><code>w_init &lt;- 3.5
alpha &lt;- 0.9
n &lt;- 5
set.seed(1)
high_wage_dummy &lt;- rbinom(n=n, size=1, prob=0.5)

plot_high_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[1]
omega_table_high_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[2]
kable(omega_table_high_init, 
      caption = &quot;Realization of spot market wages and the sequence of contract payments&quot;)</code></pre>
<table class="kable_wrapper">
<caption>
Realization of spot market wages and the sequence of contract payments
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Period</th>
<th align="left">Contract Payments</th>
<th align="left">Spot Market Wage</th>
<th align="left">Wage Update</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">3.5</td>
<td align="left">NaN</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">2.067</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">2.067</td>
<td align="left">1</td>
<td align="left">Wage Unchanged</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">2.695</td>
<td align="left">4</td>
<td align="left">Wage Updated to omega_2_lower</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">2.695</td>
<td align="left">4</td>
<td align="left">Wage Unchanged</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2.067</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot_high_init</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="TW88_code_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The table shows the change in contract payments and spot market wages. Also, the table shows how contract wages update.</p>
<p>Next, I consider the case where initial wage is between <span class="math inline">\(\omega_{2, lower}\)</span> and <span class="math inline">\(\omega_{1, upper}\)</span>.</p>
<pre class="r"><code>w_init &lt;- 2.35
alpha &lt;- 0.9
n &lt;- 5
set.seed(2)
high_wage_dummy &lt;- rbinom(n=n, size=1, prob=0.5)

plot_med_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[1]
omega_table_med_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[2]
kable(omega_table_med_init, 
      caption = &quot;Realization of spot market wages and the sequence of contract payments&quot;)</code></pre>
<table class="kable_wrapper">
<caption>
Realization of spot market wages and the sequence of contract payments
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Period</th>
<th align="left">Contract Payments</th>
<th align="left">Spot Market Wage</th>
<th align="left">Wage Update</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">2.35</td>
<td align="left">NaN</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">2.067</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">2.695</td>
<td align="left">4</td>
<td align="left">Wage Updated to omega_2_lower</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">2.695</td>
<td align="left">4</td>
<td align="left">Wage Unchanged</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">2.067</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2.695</td>
<td align="left">4</td>
<td align="left">Wage Updated to omega_2_lower</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot_med_init</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="TW88_code_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>In this case, except for the initial wage, the contract payments bounce back and force between <span class="math inline">\(\omega_{2, lower}\)</span> and <span class="math inline">\(\omega_{1, upper}\)</span>, depending on the spot market wage at the period.</p>
</div>
<div id="case-2-spot-market-like-wages" class="section level3">
<h3>Case 2: Spot-market-like wages</h3>
<p>Next, I move on and see what would happen if we have a low discount factor.</p>
<pre class="r"><code>w_init &lt;- 3.5
alpha &lt;- 0.8
n &lt;- 5
set.seed(1)
high_wage_dummy &lt;- rbinom(n=n, size=1, prob=0.5)

plot_high_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[1]
omega_table_high_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[2]
kable(omega_table_high_init, 
      caption = &quot;Realization of spot market wages and the sequence of contract payments&quot;)</code></pre>
<table class="kable_wrapper">
<caption>
Realization of spot market wages and the sequence of contract payments
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Period</th>
<th align="left">Contract Payments</th>
<th align="left">Spot Market Wage</th>
<th align="left">Wage Update</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">3.5</td>
<td align="left">NaN</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">Co-move with Spot Market Wage</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">Co-move with Spot Market Wage</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">4</td>
<td align="left">4</td>
<td align="left">Co-move with Spot Market Wage</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">4</td>
<td align="left">4</td>
<td align="left">Co-move with Spot Market Wage</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">Co-move with Spot Market Wage</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot_high_init</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="TW88_code_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>As one can see, the wage completely co-moves with spot markets wages.</p>
</div>
<div id="case-3-overlapping-regions" class="section level3">
<h3>Case 3: Overlapping regions</h3>
<p>Finally, I will try the high discount factor and see how the wages change in the overlapping region. I will show figures and tables with low and medium initial wages.</p>
<pre class="r"><code>w_init &lt;- 1.5
alpha &lt;- 0.95
n &lt;- 5
set.seed(1)
high_wage_dummy &lt;- rbinom(n=n, size=1, prob=0.5)

plot_low_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[1]
omega_table_low_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[2]
kable(omega_table_low_init, 
      caption = &quot;Realization of spot market wages and the sequence of contract payments&quot;)</code></pre>
<table class="kable_wrapper">
<caption>
Realization of spot market wages and the sequence of contract payments
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Period</th>
<th align="left">Contract Payments</th>
<th align="left">Spot Market Wage</th>
<th align="left">Wage Update</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">1.5</td>
<td align="left">NaN</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">1.5</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">1.5</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">2.326</td>
<td align="left">4</td>
<td align="left">Wage Unchanged</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">2.326</td>
<td align="left">4</td>
<td align="left">Wage Unchanged</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2.326</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot_low_init</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="TW88_code_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>w_init &lt;- 2.35
alpha &lt;- 0.95
n &lt;- 5
set.seed(1)
high_wage_dummy &lt;- rbinom(n=n, size=1, prob=0.5)

plot_med_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[1]
omega_table_med_init &lt;- wage_change_plot(w_init, alpha, n, high_wage_dummy)[2]
kable(omega_table_med_init, 
      caption = &quot;Realization of spot market wages and the sequence of contract payments&quot;)</code></pre>
<table class="kable_wrapper">
<caption>
Realization of spot market wages and the sequence of contract payments
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">Period</th>
<th align="left">Contract Payments</th>
<th align="left">Spot Market Wage</th>
<th align="left">Wage Update</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">2.35</td>
<td align="left">NaN</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">2.35</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">2.35</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">2.35</td>
<td align="left">4</td>
<td align="left">Wage Updated to omega_2_lower</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">2.35</td>
<td align="left">4</td>
<td align="left">Wage Updated to omega_2_lower</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">2.35</td>
<td align="left">1</td>
<td align="left">Wage Updated to omega_1_upper</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot_med_init</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="TW88_code_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>In the first figure, once the wage lies between <span class="math inline">\(\omega_{2, lower}\)</span> and <span class="math inline">\(\omega_{1, upper}\)</span>, the wages stays there forever no matter what the spot market wages are. It should be noted that this corresponds to <em>back-loading</em> wage schemes, where wages increase from low to high over time. In the second figure, since the initial wage already lies between <span class="math inline">\(\omega_{2, lower}\)</span> and <span class="math inline">\(\omega_{1, upper}\)</span>, the wages stays at the initial point.</p>
</div>
</div>
<div id="my-interpretations" class="section level2">
<h2>My interpretations</h2>
<p>When spot labor markets are well-developed, both employers and employees have incentives to renege contracts: employers want to fire employees and hire new ones when spot markets wages are low, and employees want to quit and find new jobs when spot markets wages are high. While this sounds reasonable, risk-averse wokres do not want to do this because of income fluctuations across time. Therefore, firms offer a contract with less fluctuating income (or no fluctuation when the discount factor is sufficiently high) and workers accept it. The beuaty of the model (to me) is the established long-term relationships without any enforcement mechanisms and with seemingly tempting outside options.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
